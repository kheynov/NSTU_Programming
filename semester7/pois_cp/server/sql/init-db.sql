drop schema if exists public cascade;
create schema if not exists public;

create table users
(
    user_id       text primary key,
    name          text,
    email         text not null,
    password_hash text,
    auth_provider text not null default 'local'
);

create table refresh_tokens
(
    id         serial primary key,
    user_id    text   not null references users (user_id) on delete cascade,
    client_id  text   not null,
    token      text   not null unique,
    expires_at bigint not null
);

create table cinemas
(
    id      serial primary key not null,
    name    text               not null,
    city    text               not null,
    address text
);

create table employees
(
    id        serial primary key,
    user_id   text not null references users (user_id) on delete cascade,
    cinema_id int  not null references cinemas (id) on delete cascade
);

create table films
(
    id       serial primary key,
    name     text not null,
    duration int  not null,
    image    text
);

create table timetables
(
    id        serial primary key,
    film_id   int       not null references films (id) on DELETE cascade,
    cinema_id int       not null references cinemas (id) on delete cascade,
    price     int       not null,
    time      timestamp not null
);

create table bookings
(
    id          text primary key default gen_random_uuid(),
    user_id     text not null references users (user_id) on delete cascade,
    booked_film int  not null references timetables (id)
);

INSERT INTO users (user_id, name, email, password_hash, auth_provider)
VALUES ('ebd376eb', 'Иванов Иван Иванович', 'ivanov@cinemabooking.ru',
        '$2a$12$Zxs4d/nFyQdC1P/Dt53qze9vOkDxcZ/9OnRqnUFmwiZlUpF2DEQ6a', 'local'),
       ('a1f8f991', 'Петров Петр Петрович', 'petrov@cinemabooking.ru',
        '$2a$12$PWP6J0N/nDoVv3Ik3/lLd.kkg.e4KscLsNcD7cDR8W0JFtWwKY.u6', 'local'),
       ('21dde366', 'Сидоров Сидор Сидорович', 'sidorov@cinemabooking.ru',
        '$2a$12$VK0uWqfG.J47KxrbRQhyyelDh4SbupY1ErtEJxLBuo26FmlO5D/sW', 'local'),
       ('32adf77a', 'Александров Александр Александрович', 'alexandrov@cinemabooking.ru',
        '$2a$12$BP6o14ecItdn0r0bcBohOuE6E0mb08ar7ZLMuubyx47HDhQW49Y.e', 'local'),
       ('4e0dc99d', 'Андреев Андрей Андреевич', 'andreev@cinemabooking.ru',
        '$2a$12$3.DqrMqgsJZACI1yBhN0o.i6J/S16z6.b2QebcCEwCYJrSUpjJ2WW', 'local'),
       ('f8d5d633', 'Алексеев Алексей Алексеевич', 'alexeev@cinemabooking.ru',
        '$2a$12$snyaFn.7Or93Fv6a4KjlHuscUv6kjwVTmvJIj8mKx68IYDe7NG5I6', 'local'),
       ('303bd871', 'Антонов Антон Антонович', 'antonov@cinemabooking.ru',
        '$2a$12$qyiduzaStn.wsWVTjMs3qe1fIBAe1rFMnEaaATv9vBjIMzK4QSkb2', 'local');

insert into films (name, duration, image)
values ('Аватар', 162,
        'https://papik.pro/grafic/uploads/posts/2023-04/1681383842_papik-pro-p-plakat-avatar-2009-19.jpg'),
       ('Титаник', 194, 'https://i.pinimg.com/originals/75/1f/54/751f5482facac19cff49ca5e0a0861cf.jpg'),
       ('Зеленая миля', 189,
        'https://movies.k210.org/images/movies/427/posters/original/7HAVOQNJu8HuR6bhN37TfxSc5q7.jpg'),
       ('Форрест Гамп', 142, 'https://artworks.thetvdb.com/banners/v4/movie/294/posters/607b6a4f83abe.jpg'),
       ('Интерстеллар', 169, 'https://i.pinimg.com/originals/8e/0d/ab/8e0dab8699be85720ce55845065bf6dc.jpg'),
       ('Иван Васильевич меняет профессию', 93,
        'https://main-cdn.sbermegamarket.ru/hlr-system/128/344/142/831/195/2/600004450760b0.jpeg'),
       ('Крестный отец', 175,
        'https://avatars.mds.yandex.net/get-kinopoisk-image/1599028/c11652e8-653b-47c1-8e72-1552399a775b/600x900'),
       ('Криминальное чтиво', 154, 'https://upload.wikimedia.org/wikipedia/ru/9/93/Pulp_Fiction.jpg'),
       ('Начало', 148, 'https://upload.wikimedia.org/wikipedia/ru/b/bc/Poster_Inception_film_2010.jpg'),
       ('Операция «Ы» и другие приключения Шурика', 95,
        'https://upload.wikimedia.org/wikipedia/ru/b/ba/Операция_Ы_фильм_плакат.jpeg');

insert into cinemas (name, city, address)
values ('КиноСити', 'Новосибирск', 'ул. Фрунзе, 238'),
       ('CINEMA PUBLIC', 'Новосибирск', 'пос.Кольцово, д.19'),
       ('Синема Парк', 'Новосибирск', 'площадь Карла Маркса, 7'),
       ('Формула кино', 'Новосибирск', ' ул. Военная, 5'),
       ('Каро 10', 'Новосибирск', 'ул. Гоголя, 13'),
       ('Аврора', 'Новосибирск', 'проспект Карла Маркса, 49'),
       ('Синема Парк', 'Новосибирск', 'ул. Красный проспект, 101');


insert into employees (user_id, cinema_id)
values ('ebd376eb', 1),
       ('a1f8f991', 2),
       ('21dde366', 3),
       ('32adf77a', 4),
       ('4e0dc99d', 5),
       ('f8d5d633', 6),
       ('303bd871', 7);

insert into timetables (film_id, cinema_id, price, time)
values (1, 1, 240, '2022-12-01 10:00:00'),
       (1, 2, 320, '2022-12-01 12:00:00'),
       (1, 3, 350, '2022-12-01 14:00:00'),
       (1, 4, 380, '2022-12-01 16:00:00'),
       (1, 5, 420, '2022-12-01 18:00:00'),
       (1, 6, 300, '2022-12-01 20:00:00'),
       (1, 7, 190, '2022-12-01 22:00:00'),
       (1, 2, 240, '2022-12-02 10:00:00'),
       (1, 1, 320, '2022-12-02 12:00:00'),
       (1, 4, 350, '2022-12-02 14:00:00'),
       (1, 5, 380, '2022-12-02 16:00:00'),
       (1, 6, 420, '2022-12-02 18:00:00'),
       (1, 7, 300, '2022-12-02 20:00:00'),
       (1, 1, 190, '2022-12-02 22:00:00'),
       (1, 2, 240, '2022-12-03 10:00:00'),
       (1, 3, 320, '2022-12-03 12:00:00'),
       (1, 5, 350, '2022-12-03 14:00:00'),
       (1, 7, 380, '2022-12-03 16:00:00'),
       (1, 2, 420, '2022-12-03 18:00:00'),
       (1, 1, 300, '2022-12-03 20:00:00'),
       (1, 4, 190, '2022-12-03 22:00:00'),
       (1, 6, 240, '2022-12-04 10:00:00'),
       (1, 1, 320, '2022-12-04 12:00:00'),
       (1, 2, 350, '2022-12-04 14:00:00'),
       (1, 3, 380, '2022-12-04 16:00:00'),
       (1, 6, 420, '2022-12-04 18:00:00'),
       (1, 4, 300, '2022-12-04 20:00:00'),
       (1, 1, 190, '2022-12-04 22:00:00'),
       (1, 2, 240, '2022-12-05 10:00:00'),
       (1, 3, 320, '2022-12-05 12:00:00'),
       (1, 4, 350, '2022-12-05 14:00:00'),
       (1, 5, 380, '2022-12-05 16:00:00'),
       (1, 6, 420, '2022-12-05 18:00:00'),
       (1, 7, 300, '2022-12-05 20:00:00'),
       (1, 1, 190, '2022-12-05 22:00:00'),
       (2, 1, 240, '2022-12-01 10:00:00'),
       (2, 2, 320, '2022-12-01 12:00:00'),
       (2, 3, 350, '2022-12-01 14:00:00'),
       (2, 4, 380, '2022-12-01 16:00:00'),
       (2, 5, 420, '2022-12-01 18:00:00'),
       (2, 6, 300, '2022-12-01 20:00:00'),
       (2, 7, 190, '2022-12-01 22:00:00'),
       (2, 2, 240, '2022-12-02 10:00:00'),
       (2, 1, 320, '2022-12-02 12:00:00'),
       (2, 4, 350, '2022-12-02 14:00:00'),
       (2, 5, 380, '2022-12-02 16:00:00'),
       (2, 6, 420, '2022-12-02 18:00:00'),
       (2, 7, 300, '2022-12-02 20:00:00'),
       (2, 1, 190, '2022-12-02 22:00:00'),
       (2, 2, 240, '2022-12-03 10:00:00'),
       (2, 3, 320, '2022-12-03 12:00:00'),
       (2, 5, 350, '2022-12-03 14:00:00'),
       (2, 7, 380, '2022-12-03 16:00:00'),
       (2, 2, 420, '2022-12-03 18:00:00'),
       (2, 1, 300, '2022-12-03 20:00:00'),
       (2, 4, 190, '2022-12-03 22:00:00'),
       (2, 6, 240, '2022-12-04 10:00:00'),
       (2, 1, 320, '2022-12-04 12:00:00'),
       (2, 2, 350, '2022-12-04 14:00:00'),
       (2, 3, 380, '2022-12-04 16:00:00'),
       (2, 6, 420, '2022-12-04 18:00:00'),
       (2, 4, 300, '2022-12-04 20:00:00'),
       (2, 1, 190, '2022-12-04 22:00:00'),
       (2, 2, 240, '2022-12-05 10:00:00'),
       (2, 3, 320, '2022-12-05 12:00:00'),
       (2, 4, 350, '2022-12-05 14:00:00'),
       (2, 5, 380, '2022-12-05 16:00:00'),
       (2, 6, 420, '2022-12-05 18:00:00'),
       (2, 7, 300, '2022-12-05 20:00:00'),
       (2, 1, 190, '2022-12-05 22:00:00'),
       (3, 1, 240, '2022-12-01 10:00:00'),
       (3, 2, 320, '2022-12-01 12:00:00'),
       (3, 3, 350, '2022-12-01 14:00:00'),
       (3, 4, 380, '2022-12-01 16:00:00'),
       (3, 5, 420, '2022-12-01 18:00:00'),
       (3, 6, 300, '2022-12-01 20:00:00'),
       (3, 7, 190, '2022-12-01 22:00:00'),
       (3, 2, 240, '2022-12-02 10:00:00'),
       (3, 1, 320, '2022-12-02 12:00:00'),
       (3, 4, 350, '2022-12-02 14:00:00'),
       (3, 5, 380, '2022-12-02 16:00:00'),
       (3, 6, 420, '2022-12-02 18:00:00'),
       (3, 7, 300, '2022-12-02 20:00:00'),
       (3, 1, 190, '2022-12-02 22:00:00'),
       (3, 2, 240, '2022-12-03 10:00:00'),
       (3, 3, 320, '2022-12-03 12:00:00'),
       (3, 5, 350, '2022-12-03 14:00:00'),
       (3, 7, 380, '2022-12-03 16:00:00'),
       (3, 2, 420, '2022-12-03 18:00:00'),
       (3, 1, 300, '2022-12-03 20:00:00'),
       (3, 4, 190, '2022-12-03 22:00:00'),
       (3, 6, 240, '2022-12-04 10:00:00'),
       (3, 1, 320, '2022-12-04 12:00:00'),
       (3, 2, 350, '2022-12-04 14:00:00'),
       (3, 3, 380, '2022-12-04 16:00:00'),
       (3, 6, 420, '2022-12-04 18:00:00'),
       (3, 4, 300, '2022-12-04 20:00:00'),
       (3, 1, 190, '2022-12-04 22:00:00'),
       (3, 2, 240, '2022-12-05 10:00:00'),
       (3, 3, 320, '2022-12-05 12:00:00'),
       (3, 4, 350, '2022-12-05 14:00:00'),
       (3, 5, 380, '2022-12-05 16:00:00'),
       (3, 6, 420, '2022-12-05 18:00:00'),
       (3, 7, 300, '2022-12-05 20:00:00'),
       (3, 1, 190, '2022-12-05 22:00:00'),
       (4, 1, 240, '2022-12-01 10:00:00'),
       (4, 2, 320, '2022-12-01 12:00:00'),
       (4, 3, 350, '2022-12-01 14:00:00'),
       (4, 4, 380, '2022-12-01 16:00:00'),
       (4, 5, 420, '2022-12-01 18:00:00'),
       (4, 6, 300, '2022-12-01 20:00:00'),
       (4, 7, 190, '2022-12-01 22:00:00'),
       (4, 2, 240, '2022-12-02 10:00:00'),
       (4, 1, 320, '2022-12-02 12:00:00'),
       (4, 4, 350, '2022-12-02 14:00:00'),
       (4, 5, 380, '2022-12-02 16:00:00'),
       (4, 6, 420, '2022-12-02 18:00:00'),
       (4, 7, 300, '2022-12-02 20:00:00'),
       (4, 1, 190, '2022-12-02 22:00:00'),
       (4, 2, 240, '2022-12-03 10:00:00'),
       (4, 3, 320, '2022-12-03 12:00:00'),
       (4, 5, 350, '2022-12-03 14:00:00'),
       (4, 7, 380, '2022-12-03 16:00:00'),
       (4, 2, 420, '2022-12-03 18:00:00'),
       (4, 1, 300, '2022-12-03 20:00:00'),
       (4, 4, 190, '2022-12-03 22:00:00'),
       (4, 6, 240, '2022-12-04 10:00:00'),
       (4, 1, 320, '2022-12-04 12:00:00'),
       (4, 2, 350, '2022-12-04 14:00:00'),
       (4, 3, 380, '2022-12-04 16:00:00'),
       (4, 6, 420, '2022-12-04 18:00:00'),
       (4, 4, 300, '2022-12-04 20:00:00'),
       (4, 1, 190, '2022-12-04 22:00:00'),
       (4, 2, 240, '2022-12-05 10:00:00'),
       (4, 3, 320, '2022-12-05 12:00:00'),
       (4, 4, 350, '2022-12-05 14:00:00'),
       (4, 5, 380, '2022-12-05 16:00:00'),
       (4, 6, 420, '2022-12-05 18:00:00'),
       (4, 7, 300, '2022-12-05 20:00:00'),
       (4, 1, 190, '2022-12-05 22:00:00'),
       (5, 1, 240, '2022-12-01 10:00:00'),
       (5, 2, 320, '2022-12-01 12:00:00'),
       (5, 3, 350, '2022-12-01 14:00:00'),
       (5, 4, 380, '2022-12-01 16:00:00'),
       (5, 5, 420, '2022-12-01 18:00:00'),
       (5, 6, 300, '2022-12-01 20:00:00'),
       (5, 7, 190, '2022-12-01 22:00:00'),
       (5, 2, 240, '2022-12-02 10:00:00'),
       (5, 1, 320, '2022-12-02 12:00:00'),
       (6, 4, 350, '2022-12-02 14:00:00'),
       (6, 5, 380, '2022-12-02 16:00:00'),
       (6, 6, 420, '2022-12-02 18:00:00'),
       (6, 7, 300, '2022-12-02 20:00:00'),
       (6, 1, 190, '2022-12-02 22:00:00'),
       (6, 2, 240, '2022-12-03 10:00:00'),
       (6, 3, 320, '2022-12-03 12:00:00'),
       (6, 5, 350, '2022-12-03 14:00:00'),
       (6, 7, 380, '2022-12-03 16:00:00'),
       (6, 2, 420, '2022-12-03 18:00:00'),
       (6, 1, 300, '2022-12-03 20:00:00'),
       (6, 4, 190, '2022-12-03 22:00:00'),
       (6, 6, 240, '2022-12-04 10:00:00'),
       (6, 1, 320, '2022-12-04 12:00:00'),
       (6, 2, 350, '2022-12-04 14:00:00'),
       (7, 3, 380, '2022-12-04 16:00:00'),
       (7, 6, 420, '2022-12-04 18:00:00'),
       (7, 4, 300, '2022-12-04 20:00:00'),
       (7, 1, 190, '2022-12-04 22:00:00'),
       (7, 2, 240, '2022-12-05 10:00:00'),
       (7, 3, 320, '2022-12-05 12:00:00'),
       (7, 4, 350, '2022-12-05 14:00:00'),
       (7, 5, 380, '2022-12-05 16:00:00'),
       (7, 6, 420, '2022-12-05 18:00:00'),
       (7, 7, 300, '2022-12-05 20:00:00'),
       (7, 1, 190, '2022-12-05 22:00:00'),
       (8, 1, 240, '2022-12-01 10:00:00'),
       (8, 2, 320, '2022-12-01 12:00:00'),
       (8, 3, 350, '2022-12-01 14:00:00'),
       (8, 4, 380, '2022-12-01 16:00:00'),
       (8, 5, 420, '2022-12-01 18:00:00'),
       (8, 6, 300, '2022-12-01 20:00:00'),
       (8, 7, 190, '2022-12-01 22:00:00'),
       (8, 2, 240, '2022-12-02 10:00:00'),
       (8, 1, 320, '2022-12-02 12:00:00'),
       (8, 4, 350, '2022-12-02 14:00:00'),
       (8, 5, 380, '2022-12-02 16:00:00'),
       (8, 6, 420, '2022-12-02 18:00:00'),
       (8, 7, 300, '2022-12-02 20:00:00'),
       (8, 1, 190, '2022-12-02 22:00:00'),
       (8, 2, 240, '2022-12-03 10:00:00'),
       (8, 3, 320, '2022-12-03 12:00:00'),
       (8, 5, 350, '2022-12-03 14:00:00'),
       (8, 7, 380, '2022-12-03 16:00:00'),
       (8, 2, 420, '2022-12-03 18:00:00'),
       (8, 1, 300, '2022-12-03 20:00:00'),
       (8, 4, 190, '2022-12-03 22:00:00'),
       (8, 6, 240, '2022-12-04 10:00:00'),
       (8, 1, 320, '2022-12-04 12:00:00'),
       (8, 2, 350, '2022-12-04 14:00:00'),
       (8, 3, 380, '2022-12-04 16:00:00'),
       (8, 6, 420, '2022-12-04 18:00:00'),
       (8, 4, 300, '2022-12-04 20:00:00'),
       (8, 1, 190, '2022-12-04 22:00:00'),
       (8, 2, 240, '2022-12-05 10:00:00'),
       (8, 3, 320, '2022-12-05 12:00:00'),
       (8, 4, 350, '2022-12-05 14:00:00'),
       (8, 5, 380, '2022-12-05 16:00:00'),
       (8, 6, 420, '2022-12-05 18:00:00'),
       (9, 7, 300, '2022-12-05 20:00:00'),
       (9, 1, 190, '2022-12-05 22:00:00'),
       (9, 2, 240, '2022-12-01 10:00:00'),
       (9, 3, 320, '2022-12-01 12:00:00'),
       (9, 4, 350, '2022-12-01 14:00:00'),
       (9, 5, 380, '2022-12-01 16:00:00'),
       (9, 6, 420, '2022-12-01 18:00:00'),
       (9, 7, 300, '2022-12-01 20:00:00'),
       (9, 1, 190, '2022-12-01 22:00:00'),
       (9, 2, 240, '2022-12-02 10:00:00'),
       (9, 1, 320, '2022-12-02 12:00:00'),
       (9, 4, 350, '2022-12-02 14:00:00'),
       (9, 5, 380, '2022-12-02 16:00:00'),
       (9, 6, 420, '2022-12-02 18:00:00'),
       (9, 7, 300, '2022-12-02 20:00:00'),
       (9, 1, 190, '2022-12-02 22:00:00'),
       (9, 2, 240, '2022-12-03 10:00:00'),
       (10, 3, 320, '2022-12-03 12:00:00'),
       (10, 5, 350, '2022-12-03 14:00:00'),
       (10, 7, 380, '2022-12-03 16:00:00'),
       (10, 2, 420, '2022-12-03 18:00:00'),
       (10, 1, 300, '2022-12-03 20:00:00'),
       (10, 4, 190, '2022-12-03 22:00:00'),
       (10, 6, 240, '2022-12-04 10:00:00'),
       (10, 1, 320, '2022-12-04 12:00:00'),
       (10, 2, 350, '2022-12-04 14:00:00'),
       (10, 3, 380, '2022-12-04 16:00:00'),
       (10, 6, 420, '2022-12-04 18:00:00'),
       (10, 4, 300, '2022-12-04 20:00:00'),
       (10, 1, 190, '2022-12-04 22:00:00'),
       (10, 2, 240, '2022-12-05 10:00:00'),
       (10, 3, 320, '2022-12-05 12:00:00'),
       (10, 4, 350, '2022-12-05 14:00:00');
            